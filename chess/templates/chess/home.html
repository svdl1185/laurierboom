<!-- templates/chess/home.html -->
{% extends 'chess/base.html' %}

{% block title %}De Laurierboom{% endblock %}

{% block content %}

<!-- Two-column layout for tournament agenda and player rankings -->
<div class="row">
    <!-- Left Column: Tournament Agenda -->
    <div class="col-md-6 mb-4">
        <div class="card border-0 shadow h-100">
            <div class="card-header bg-dark text-white py-3">
                <h2 class="card-title mb-0">
                    <i class="fas fa-calendar-alt me-2"></i>Agenda
                </h2>
            </div>
            <div class="card-body p-0">
                <div class="list-group list-group-flush">
                    {% for tournament in upcoming_tournaments %}
                        <a href="{% url 'tournament_detail' tournament.id %}" class="list-group-item list-group-item-action border-0 py-3">
                            <div class="d-flex w-100 justify-content-between">
                                <h5 class="mb-1">{{ tournament.name }}</h5>
                                <span class="tournament-type-badge time-{% if tournament.time_control %}{{ tournament.time_control }}{% else %}tbd{% endif %}">
                                    {% if tournament.time_control == 'bullet' %}
                                        Bullet
                                    {% elif tournament.time_control == 'blitz' %}
                                        Blitz
                                    {% elif tournament.time_control == 'rapid' %}
                                        Rapid
                                    {% elif tournament.time_control == 'classical' %}
                                        Classical
                                    {% else %}
                                        Time TBD
                                    {% endif %}
                                </span>
                            </div>
                            <div class="tournament-info mb-1">
                                <i class="far fa-calendar-alt me-1 text-muted"></i>
                                <span class="me-3">{{ tournament.date }}</span>
                                {% if tournament.start_time %}
                                    <i class="far fa-clock me-1 text-muted"></i>
                                    <span>{{ tournament.start_time }}</span>
                                {% endif %}
                            </div>
                            <div class="tournament-info">
                                <i class="fas fa-map-marker-alt me-1 text-muted"></i>
                                <span>{{ tournament.location }}</span>
                            </div>
                            {% if tournament.description %}
                                <p class="mb-0 mt-2 small text-muted">{{ tournament.description|truncatechars:100 }}</p>
                            {% endif %}
                        </a>
                    {% empty %}
                        <div class="p-4 text-center">
                            <p class="mb-0">No upcoming tournaments scheduled</p>
                            <p class="small text-muted">Check back soon for new events!</p>
                        </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
    
    <!-- Right Column: Player Rankings -->
    <div class="col-md-6 mb-4">
        <div class="card border-0 shadow h-100">
            <div class="card-header bg-dark text-white py-3">
                <h2 class="card-title mb-0">
                    <i class="fas fa-trophy me-2"></i>Ranking
                </h2>
            </div>
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table table-hover rankings-table mb-0">
                        <thead class="table-light">
                          <tr>
                            <th class="ps-3">Rank</th>
                            <th>Player</th>
                            <th>Blitz Rating</th>
                          </tr>
                        </thead>
                        <tbody>
                          {% for player in blitz_players %}
                            <tr>
                              <td class="ps-3">
                                <div class="rank-badge {% if forloop.counter <= 3 %}rank-{{ forloop.counter }}{% else %}rank-other{% endif %}">{{ forloop.counter }}</div>
                              </td>
                              <td>
                                <a href="{% url 'player_detail' player.id %}" class="player-name">
                                  {{ player.get_full_name|default:player.username }}
                                </a>
                              </td>
                              <td>
                                <span class="rating-badge laurier">{{ player.blitz_elo|floatformat:0 }}</span>
                              </td>
                            </tr>
                          {% empty %}
                            <tr>
                              <td colspan="3" class="text-center py-4">No players yet!</td>
                            </tr>
                          {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Enable Bootstrap tooltips
    const tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
    tooltipTriggerList.map(function (tooltipTriggerEl) {
        return new bootstrap.Tooltip(tooltipTriggerEl);
    });
    
    // Enable clickable rows
    const clickableRows = document.querySelectorAll('.clickable-row');
    clickableRows.forEach(row => {
        row.addEventListener('click', function(e) {
            // Don't navigate if the user clicked on a button or link
            if (e.target.tagName === 'A' || e.target.tagName === 'BUTTON' || 
                e.target.closest('a') || e.target.closest('button')) {
                return;
            }
            
            window.location = this.dataset.href;
        });
    });
});
</script>
{% endblock %}